@model LoanProductsViewModel

@foreach (var loan in @Model.loanProducts)
{
    <div class="loan-summary-card">
        <h3>@loan.Name</h3>
        <p><strong>Principal:</strong> Ksh @loan.PrincipalAmountMin - Ksh @loan.PrincipalAmountMax</p>
        <p><strong>Interest Rate:</strong> @loan.InterestRate% (@loan.InterestRateType)</p>

        <button class="btn-toggle" type="button" onclick="toggleDetails('@loan.Id')">
            View More
        </button>

        <div id="details-@loan.Id" class="loan-details collapse">
            <h4>@loan.Name (@loan.Code)</h4>
            <p><strong>Processing Fee:</strong> Ksh @loan.ProcessingFee</p>
            <p><strong>Late Payment Penalty:</strong> Ksh @loan.LatePaymentPenalty</p>
            
            <h5>Repayment Terms</h5>
            <p><strong>Frequency:</strong> @loan.RepaymentFrequency</p>
            <p><strong>Grace Period:</strong> @loan.GracePeriodMonths months</p>
            <p><strong>Installment Type:</strong> @loan.InstallmentType</p>
            
            <h5>Collateral & Eligibility</h5>
            <p><strong>Requires Collateral:</strong> @(loan.RequiresCollateral ? "Yes" : "No")</p>
            @if (loan.RequiresCollateral)
            {
                <p><strong>Collateral Type:</strong> @loan.CollateralType</p>
            }
            <p><strong>Eligibility:</strong> @loan.EligibilityCriteria</p>
            
            <h5>Other Information</h5>
            <p><strong>Status:</strong> @(loan.Active ? "Active" : "Inactive")</p>
            <p><strong>Max Concurrent Loans:</strong> @loan.MaxConcurrentLoans</p>
            <p><strong>Prepayment Allowed:</strong> @(loan.PrepayMentAllowed ? "Yes" : "No")</p>
            @if (loan.PrepayMentPenalty.HasValue)
            {
                <p><strong>Prepayment Penalty:</strong> Ksh @loan.PrepayMentPenalty</p>
            }
            <p><strong>Currency:</strong> @loan.Currency</p>
            
            <h5>Audit Info</h5>
            <p><strong>Created:</strong> @loan.CreatedDate by @loan.CreatedBy</p>
            <p><strong>Last Updated:</strong> @loan.LastUpdated</p>

            <button class="btn-apply">Apply</button>
        </div>
    </div>
}

<style>
    .loan-summary-card {
        background: #fff;
        border: 1px solid #ddd;
        border-radius: 12px;
        padding: 20px;
        margin-bottom: 20px;
        box-shadow: 0 4px 10px rgba(0,0,0,0.08);
        max-width: 700px;
    }
    .btn-toggle {
        margin-top: 10px;
        background: #28a745;
        color: #fff;
        padding: 8px 14px;
        border: none;
        border-radius: 6px;
        cursor: pointer;
    }
    .btn-toggle:hover {
        background: #1e7e34;
    }
    .loan-details {
        margin-top: 15px;
        padding: 15px;
        border-top: 1px solid #eee;
        display: none; /* hidden by default */
    }
    .loan-details h5 {
        margin-top: 15px;
        color: #007bff;
        border-bottom: 1px solid #eee;
        padding-bottom: 5px;
    }
    .btn-apply {
        margin-top: 15px;
        background: #007bff;
        color: #fff;
        padding: 10px 18px;
        border: none;
        border-radius: 8px;
        cursor: pointer;
    }
    .btn-apply:hover {
        background: #0056b3;
    }
</style>

<script>
    function toggleDetails(id) {
        var el = document.getElementById("details-" + id);
        if (el.style.display === "none" || el.style.display === "") {
            el.style.display = "block";
        } else {
            el.style.display = "none";
        }
    }
</script>
